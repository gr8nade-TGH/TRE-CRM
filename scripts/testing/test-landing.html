<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Test Landing Pages - TRE CRM</title>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
			max-width: 800px;
			margin: 50px auto;
			padding: 20px;
			background: #f8f9fa;
		}
		h1 {
			color: #2563eb;
			margin-bottom: 10px;
		}
		.subtitle {
			color: #64748b;
			margin-bottom: 30px;
		}
		.agent-card {
			background: white;
			border: 2px solid #e5e7eb;
			border-radius: 12px;
			padding: 20px;
			margin-bottom: 15px;
			transition: all 0.2s ease;
		}
		.agent-card:hover {
			border-color: #2563eb;
			box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
		}
		.agent-name {
			font-size: 1.2rem;
			font-weight: 600;
			color: #1f2937;
			margin-bottom: 5px;
		}
		.agent-email {
			color: #64748b;
			font-size: 0.9rem;
			margin-bottom: 15px;
		}
		.button-group {
			display: flex;
			gap: 10px;
		}
		.btn {
			padding: 10px 20px;
			border: none;
			border-radius: 8px;
			font-weight: 600;
			cursor: pointer;
			text-decoration: none;
			display: inline-block;
			transition: all 0.2s ease;
		}
		.btn-primary {
			background: #2563eb;
			color: white;
		}
		.btn-primary:hover {
			background: #1e40af;
			transform: translateY(-2px);
		}
		.btn-secondary {
			background: #f1f5f9;
			color: #475569;
			border: 2px solid #cbd5e1;
		}
		.btn-secondary:hover {
			background: #e2e8f0;
		}
		.loading {
			text-align: center;
			padding: 40px;
			color: #64748b;
		}
		.error {
			background: #fef2f2;
			border: 2px solid #fca5a5;
			color: #dc2626;
			padding: 15px;
			border-radius: 8px;
			margin-bottom: 20px;
		}
		.info {
			background: #eff6ff;
			border: 2px solid #93c5fd;
			color: #1e40af;
			padding: 15px;
			border-radius: 8px;
			margin-bottom: 20px;
		}
	</style>
</head>
<body>
	<h1>üß™ Test Landing Pages</h1>
	<p class="subtitle">Click on any agent below to test their landing page</p>

	<div class="info">
		<strong>üìù Note:</strong> This page helps you test landing pages locally. Each agent's landing page URL uses their name as a slug (e.g., "john-smith").
	</div>

	<div id="agentsList">
		<div class="loading">Loading agents from Supabase...</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
	<script>
		// Initialize Supabase
		const SUPABASE_URL = 'https://mevirooooypfjbsrmzrk.supabase.co';
		const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmlyb29vb3lwZmpic3JtenJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTU1MDgsImV4cCI6MjA3NTI5MTUwOH0.FGez_nPoWZA5NKbJP54e5JsgJILrWB7rBUD4vx6iZZA';
		const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

		async function loadAgents() {
			const container = document.getElementById('agentsList');
			
			try {
				const { data: agents, error } = await supabase
					.from('users')
					.select('*')
					.eq('role', 'agent')
					.eq('active', true)
					.order('name');

				if (error) throw error;

				if (!agents || agents.length === 0) {
					container.innerHTML = '<div class="error">No active agents found in the database.</div>';
					return;
				}

				container.innerHTML = agents.map(agent => {
					const slug = agent.name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');
					const landingUrl = `landing.html?agent=${slug}`;
					
					return `
						<div class="agent-card">
							<div class="agent-name">${agent.name}</div>
							<div class="agent-email">${agent.email} ‚Ä¢ ${agent.phone || 'No phone'}</div>
							<div class="button-group">
								<a href="${landingUrl}" target="_blank" class="btn btn-primary">
									üåê Open Landing Page
								</a>
								<button class="btn btn-secondary" onclick="copyUrl('${landingUrl}')">
									üìã Copy URL
								</button>
							</div>
						</div>
					`;
				}).join('');

			} catch (error) {
				console.error('Error loading agents:', error);
				container.innerHTML = `<div class="error">Error loading agents: ${error.message}</div>`;
			}
		}

		function copyUrl(url) {
			const fullUrl = window.location.origin + window.location.pathname.replace('test-landing.html', '') + url;
			navigator.clipboard.writeText(fullUrl).then(() => {
				alert('‚úÖ URL copied to clipboard!\n\n' + fullUrl);
			}).catch(err => {
				console.error('Failed to copy:', err);
				alert('‚ùå Failed to copy URL');
			});
		}

		// Load agents on page load
		loadAgents();
	</script>
</body>
</html>

