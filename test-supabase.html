<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase Connection Test</title>
</head>
<body>
    <h1>Supabase Connection Test</h1>
    <div id="status">Testing connection...</div>
    <div id="data"></div>
    
    <!-- Supabase Client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-client.js"></script>
    
    <script>
        // Test the connection when page loads
        window.addEventListener('load', async () => {
            const statusDiv = document.getElementById('status');
            const dataDiv = document.getElementById('data');
            
            try {
                const isConnected = await testSupabaseConnection();
                
                if (isConnected) {
                    statusDiv.innerHTML = '✅ Supabase connection successful!';
                    statusDiv.style.color = 'green';
                    
                    // Try to fetch all data
                    const leads = await fetchLeads();
                    const properties = await fetchProperties();
                    const agents = await fetchAgents();
                    const specials = await fetchSpecials();
                    const bugs = await fetchBugs();
                    
                    dataDiv.innerHTML = `
                        <h3>Data from Supabase:</h3>
                        <p><strong>Leads:</strong> ${leads.length} records</p>
                        <p><strong>Properties:</strong> ${properties.length} records</p>
                        <p><strong>Agents:</strong> ${agents.length} records</p>
                        <p><strong>Specials:</strong> ${specials.length} records</p>
                        <p><strong>Bugs:</strong> ${bugs.length} records</p>
                        <h4>Sample Data:</h4>
                        <pre>${JSON.stringify({
                            leads: leads.slice(0, 1), 
                            properties: properties.slice(0, 1),
                            agents: agents.slice(0, 1),
                            specials: specials.slice(0, 1),
                            bugs: bugs.slice(0, 1)
                        }, null, 2)}</pre>
                    `;
                } else {
                    statusDiv.innerHTML = '❌ Supabase connection failed!';
                    statusDiv.style.color = 'red';
                }
            } catch (error) {
                statusDiv.innerHTML = `❌ Error: ${error.message}`;
                statusDiv.style.color = 'red';
            }
        });
    </script>
</body>
</html>
