<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>Find Your Perfect Apartment - Texas Relocation Experts</title>
	<link rel="stylesheet" href="styles.css" />
	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
	<style>
		.landing-page {
			font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
			line-height: 1.6;
			color: #333;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			min-height: 100vh;
			margin: 0;
			padding: 0;
		}
		.landing-container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 0 20px;
		}
		.landing-header {
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(10px);
			padding: 20px 0;
			box-shadow: 0 2px 20px rgba(0,0,0,0.1);
		}
		.landing-logo {
			text-align: center;
			margin-bottom: 20px;
		}
		.landing-logo img {
			height: 60px;
		}
		.landing-hero {
			text-align: center;
			padding: 60px 0;
			color: white;
		}
		.landing-hero h1 {
			font-size: 3rem;
			margin-bottom: 20px;
			text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
		}
		.landing-hero p {
			font-size: 1.2rem;
			margin-bottom: 40px;
		}
		.landing-form {
			background: white;
			padding: 40px;
			border-radius: 15px;
			box-shadow: 0 10px 30px rgba(0,0,0,0.2);
			margin: 40px 0;
		}
		.form-group {
			margin-bottom: 20px;
		}
		.form-group label {
			display: block;
			margin-bottom: 8px;
			font-weight: 600;
			color: #333;
		}
		.form-group input,
		.form-group select,
		.form-group textarea {
			width: 100%;
			padding: 12px;
			border: 2px solid #e1e5e9;
			border-radius: 8px;
			font-size: 16px;
			transition: border-color 0.3s ease;
			box-sizing: border-box;
		}
		.form-group input:focus,
		.form-group select:focus,
		.form-group textarea:focus {
			outline: none;
			border-color: #667eea;
		}
		.form-row {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 20px;
		}
		.submit-btn {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
			padding: 15px 30px;
			border: none;
			border-radius: 8px;
			font-size: 18px;
			font-weight: 600;
			cursor: pointer;
			width: 100%;
			transition: transform 0.3s ease;
		}
		.submit-btn:hover {
			transform: translateY(-2px);
		}
		.submit-btn:disabled {
			opacity: 0.6;
			cursor: not-allowed;
		}
		.landing-footer {
			background: #1a1a1a;
			color: white;
			padding: 40px 0;
			text-align: center;
		}
		.social-links {
			margin: 20px 0;
		}
		.social-links a {
			color: white;
			margin: 0 15px;
			text-decoration: none;
			font-size: 1.2rem;
		}
		.social-links a:hover {
			color: #667eea;
		}
		@media (max-width: 768px) {
			.form-row {
				grid-template-columns: 1fr;
			}
			.landing-hero h1 {
				font-size: 2rem;
			}
		}
	</style>
</head>
<body>
	<div class="landing-page">
		<div class="landing-header">
			<div class="landing-container">
				<div class="landing-logo">
					<img src="images/tre_logo_black_bg.png" alt="TRE CRM" />
				</div>
			</div>
		</div>
		
		<div class="landing-hero">
			<div class="landing-container">
				<h1>Schedule an Appointment</h1>
				<p id="agentName">Choose a time that best suits you and we'll make it happen!</p>
				<p style="font-size: 1.5rem; font-weight: bold;">Are you ready for your new apartment? GREAT!!</p>
				<p>Please fill out the form below and I'll be in contact with you TODAY!</p>
			</div>
		</div>
		
		<div class="landing-container">
			<div class="landing-form">
				<p style="text-align: center; margin-bottom: 30px; color: #666; font-style: italic;">Fields marked with an * are required</p>
				
				<form id="leadForm">
					<div class="form-row">
						<div class="form-group">
							<label for="name">Name: *</label>
							<input type="text" id="name" name="name" required>
						</div>
						<div class="form-group">
							<label for="phone">Phone: *</label>
							<input type="tel" id="phone" name="phone" required>
						</div>
					</div>
					
					<div class="form-row">
						<div class="form-group">
							<label for="email">Email: *</label>
							<input type="email" id="email" name="email" required>
						</div>
						<div class="form-group">
							<label for="bestTime">Best time to call you: *</label>
							<select id="bestTime" name="bestTime" required>
								<option value="">Select</option>
								<option value="morning">Morning (8AM-12PM)</option>
								<option value="afternoon">Afternoon (12PM-5PM)</option>
								<option value="evening">Evening (5PM-8PM)</option>
								<option value="anytime">Anytime</option>
							</select>
						</div>
					</div>
					
					<div class="form-row">
						<div class="form-group">
							<label for="bedrooms"># of Bedrooms: *</label>
							<select id="bedrooms" name="bedrooms" required>
								<option value="">Select</option>
								<option value="studio">Studio</option>
								<option value="1">1 Bedroom</option>
								<option value="2">2 Bedrooms</option>
								<option value="3">3 Bedrooms</option>
								<option value="4">4 Bedrooms</option>
								<option value="5+">5+ Bedrooms</option>
							</select>
						</div>
						<div class="form-group">
							<label for="bathrooms"># of Bathrooms: *</label>
							<select id="bathrooms" name="bathrooms" required>
								<option value="">Select</option>
								<option value="1">1 Bathroom</option>
								<option value="1.5">1.5 Bathrooms</option>
								<option value="2">2 Bathrooms</option>
								<option value="2.5">2.5 Bathrooms</option>
								<option value="3">3 Bathrooms</option>
								<option value="3+">3+ Bathrooms</option>
							</select>
						</div>
					</div>
					
					<div class="form-row">
						<div class="form-group">
							<label for="priceRange">Price Range: *</label>
							<select id="priceRange" name="priceRange" required>
								<option value="">Select</option>
								<option value="under-1000">Under $1,000</option>
								<option value="1000-1500">$1,000 - $1,500</option>
								<option value="1500-2000">$1,500 - $2,000</option>
								<option value="2000-2500">$2,000 - $2,500</option>
								<option value="2500-3000">$2,500 - $3,000</option>
								<option value="3000-4000">$3,000 - $4,000</option>
								<option value="4000+">$4,000+</option>
							</select>
						</div>
						<div class="form-group">
							<label for="areaOfTown">Area of Town: *</label>
							<select id="areaOfTown" name="areaOfTown" required>
								<option value="">Select</option>
								<option value="downtown">Downtown</option>
								<option value="north-side">North Side</option>
								<option value="south-side">South Side</option>
								<option value="east-side">East Side</option>
								<option value="west-side">West Side</option>
								<option value="northwest">Northwest</option>
								<option value="northeast">Northeast</option>
								<option value="southwest">Southwest</option>
								<option value="southeast">Southeast</option>
								<option value="suburbs">Suburbs</option>
								<option value="flexible">Flexible</option>
							</select>
						</div>
					</div>
					
					<div class="form-row">
						<div class="form-group">
							<label for="moveInDate">Target move in Date: *</label>
							<input type="date" id="moveInDate" name="moveInDate" required>
						</div>
						<div class="form-group">
							<label for="creditHistory">Credit History: *</label>
							<select id="creditHistory" name="creditHistory" required>
								<option value="">Select</option>
								<option value="excellent">Excellent (750+)</option>
								<option value="good">Good (700-749)</option>
								<option value="fair">Fair (650-699)</option>
								<option value="poor">Poor (Below 650)</option>
								<option value="no-credit">No Credit History</option>
							</select>
						</div>
					</div>
					
					<div class="form-group">
						<label for="comments">Lease Term / Special Requirements / Comments / Desired Neighborhoods:</label>
						<textarea id="comments" name="comments" rows="4" placeholder="Any specific requirements or comments..."></textarea>
					</div>
					
					<button type="submit" class="submit-btn">Submit My Information</button>
				</form>
			</div>
		</div>
		
		<div class="landing-footer">
			<div class="landing-container">
				<img src="images/tre_logo_black_bg.png" alt="TRE CRM" style="height: 40px; margin-bottom: 20px;" />
				<p>&copy; 2025 Texas Relocation Experts. All rights reserved.</p>
			</div>
		</div>
	</div>

	<script>
		// Initialize Supabase client
		const SUPABASE_URL = 'https://mevirooooypfjbsrmzrk.supabase.co';
		const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmlyb29vb3lwZmpic3JtenJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTU1MDgsImV4cCI6MjA3NTI5MTUwOH0.FGez_nPoWZA5NKbJP54e5JsgJILrWB7rBUD4vx6iZZA';

		const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

		// Get agent email from URL parameter
		const urlParams = new URLSearchParams(window.location.search);
		const agentEmail = urlParams.get('agent');

		// Fetch agent info from Supabase
		async function loadAgentInfo() {
			if (!agentEmail) {
				return null;
			}

			try {
				const { data, error } = await supabase
					.from('users')
					.select('*')
					.eq('email', agentEmail)
					.eq('role', 'agent')
					.single();

				if (error) throw error;

				if (data) {
					document.getElementById('agentName').textContent = `Find your perfect apartment with ${data.name}!`;
					return data;
				}
			} catch (error) {
				console.error('Error loading agent:', error);
			}

			return null;
		}

		// Load agent info on page load
		let currentAgent = null;
		loadAgentInfo().then(agent => {
			currentAgent = agent;
		});

		// Handle form submission
		document.getElementById('leadForm').addEventListener('submit', async function(e) {
			e.preventDefault();

			const submitBtn = this.querySelector('button[type="submit"]');
			submitBtn.disabled = true;
			submitBtn.textContent = 'Submitting...';

			const formData = new FormData(this);

			// Build preferences object
			const preferences = {
				bedrooms: formData.get('bedrooms'),
				bathrooms: formData.get('bathrooms'),
				priceRange: formData.get('priceRange'),
				areaOfTown: formData.get('areaOfTown'),
				moveInDate: formData.get('moveInDate'),
				creditHistory: formData.get('creditHistory'),
				bestTimeToCall: formData.get('bestTime'),
				comments: formData.get('comments')
			};

			const leadData = {
				name: formData.get('name'),
				phone: formData.get('phone'),
				email: formData.get('email'),
				preferences: JSON.stringify(preferences),
				source: 'landing_page',
				health_status: 'new',
				assigned_agent_id: agentEmail || null,
				found_by_agent_id: agentEmail || null,
				submitted_at: new Date().toISOString(),
				created_at: new Date().toISOString(),
				updated_at: new Date().toISOString()
			};

			try {
				const { data, error } = await supabase
					.from('leads')
					.insert([leadData])
					.select();

				if (error) throw error;

				// Success!
				alert('Thank you! We\'ll be in touch with you TODAY!');
				this.reset();

			} catch (error) {
				console.error('Error submitting form:', error);
				alert('Thank you for your interest! We\'ll contact you soon.');
				this.reset();
			} finally {
				submitBtn.disabled = false;
				submitBtn.textContent = 'Submit My Information';
			}
		});
	</script>
</body>
</html>

